---
import Layout from '../layouts/Slide.astro';
import img_placa from '../assets/img/yligo_780_g.jpg';
---

<style>
  @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap');

  /* --- LAYOUT --- */
  .slide-container {
    width: 100vw;
    height: 100vh;
    background-color: #ffffff;
    background-image: radial-gradient(circle at 50% 50%, rgba(29, 78, 137, 0.02) 0%, transparent 60%);
    display: flex;
    flex-direction: column;
    font-family: 'Manrope', sans-serif;
    overflow: hidden;
    padding: 2rem 4rem;
    box-sizing: border-box;
    position: relative;
  }

  h1 {
    font-size: 3.5rem;
    font-weight: 800;
    color: #0f172a;
    margin: 0 0 1.5rem 0;
    letter-spacing: -1.5px;
    z-index: 10;
    opacity: 0;
    animation: fadeInDown 0.8s ease-out forwards; /* Título entra solo */
  }
  
  h1 span { color: #1D4E89; }

  /* --- CANVAS (FONDO) --- */
  #connections-canvas {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 1;
    pointer-events: none;
    opacity: 0;
    animation: fadeIn 1s ease-out 1.5s forwards; /* Las líneas aparecen al final */
  }

  /* --- GRID --- */
  .diagram-grid {
    display: grid;
    width: 100%;
    flex-grow: 1;
    grid-template-columns: 280px 1fr 1.5fr 1fr; 
    grid-template-rows: 1fr 1fr 1fr;
    gap: 2rem 4rem; 
    grid-template-areas:
      "iot   api    n8n    ai"
      "iot   mqtt   core   front"
      "iot   .      db     front";
    align-items: center;
    justify-items: center;
    position: relative;
    z-index: 2;
  }

  /* --- NODOS (TARJETAS) --- */
  .node {
    background: #fff;
    border: 1px solid #e2e8f0;
    border-left: 5px solid #1D4E89;
    border-radius: 12px;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.08);
    position: relative;
    width: 100%;
    max-width: 280px;
    
    /* ESTADO INICIAL: INVISIBLE */
    opacity: 0;
    transform: translateY(20px);
    /* La animación se define inline en el HTML para controlar el orden */
  }

  /* ANIMACIÓN DE "RESPIRACIÓN" (FLOATING) 
     Se activa después de la entrada para mantener la slide viva */
  .node {
    animation-fill-mode: forwards; /* Mantiene el estado final */
  }

  .node-title { font-weight: 800; font-size: 1.1rem; color: #0f172a; line-height: 1.1; }
  .node-subtitle { font-size: 0.75rem; color: #64748b; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }

  /* --- ZONA IOT --- */
  #node-iot {
    grid-area: iot;
    height: 90%;
    width: 100%;
    background: linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);
    border: 1px solid #e2e8f0;
    border-radius: 24px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    box-shadow: 0 20px 40px -10px rgba(29, 78, 137, 0.1);
    position: relative;
    overflow: hidden;
    
    /* Animación Específica IoT */
    opacity: 0;
    animation: slideInLeft 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) 0.2s forwards;
  }

  .iot-badge {
    background: #0f172a; color: white; padding: 6px 16px; border-radius: 20px;
    font-size: 0.75rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; z-index: 2;
  }

  .hardware-stage {
    position: relative; width: 180px; height: 260px;
    background: #e2e8f0; border-radius: 16px; padding: 10px;
    display: flex; align-items: center; justify-content: center;
    border: 1px solid #cbd5e1; overflow: hidden;
  }

  .hardware-img { width: 100%; height: 100%; object-fit: contain; border-radius: 8px; z-index: 1; }

  /* ESCANER AUTOMÁTICO (LASER) */
  .scan-laser {
    position: absolute; top: 0; left: 0; width: 100%; height: 2px;
    background: #1D4E89; box-shadow: 0 0 15px 4px rgba(29, 78, 137, 0.5);
    opacity: 0.8; z-index: 2;
    animation: scanMove 3s ease-in-out infinite; /* SE MUEVE SIEMPRE */
  }

  /* Posicionamiento */
  #node-api { grid-area: api; align-self: end; }
  #node-n8n { grid-area: n8n; align-self: end; width: 100%; }
  #node-ai { grid-area: ai; align-self: end; }
  #node-mqtt { grid-area: mqtt; }
  #node-core { grid-area: core; width: 100%; padding: 2rem; background: #f8fafc; }
  #node-db { grid-area: db; align-self: start; }
  #node-front { grid-area: front; }

  .icon-box { width: 40px; height: 40px; display: flex; align-items: center; margin-bottom: 0.5rem; }
  .icon-box svg { width: 100%; height: 100%; object-fit: contain; }

  /* --- KEYFRAMES (ANIMACIONES) --- */
  
  /* 1. Entrada Título */
  @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
  
  /* 2. Entrada Lateral IoT */
  @keyframes slideInLeft { from { opacity: 0; transform: translateX(-50px); } to { opacity: 1; transform: translateX(0); } }
  
  /* 3. Entrada Tarjetas (Pop Up) */
  @keyframes popUp { 
    0% { opacity: 0; transform: translateY(30px) scale(0.9); } 
    100% { opacity: 1; transform: translateY(0) scale(1); } 
  }

  /* 4. Respiración (Movimiento continuo sutil) */
  @keyframes floatBreathing {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }

  /* 5. Escáner */
  @keyframes scanMove {
    0% { top: 5%; opacity: 0; }
    20% { opacity: 1; }
    80% { opacity: 1; }
    100% { top: 95%; opacity: 0; }
  }

  @keyframes fadeIn { to { opacity: 1; } }

  /* CLASE DE UTILIDAD PARA ANIMAR */
  /* Combina la entrada (una vez) con la flotación (infinita) */
  .animate-card {
    /* Nombre animaciones | Duración | Curva | Delay | Iteraciones | Dirección */
    animation: 
      popUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards, 
      floatBreathing 4s ease-in-out infinite;
  }

</style>

<Layout title="Arquitectura del Sistema">
  <div class="slide-container" id="slide-container">
    
    <h1>Arquitectura del Sistema<span>.</span></h1>

    <canvas id="connections-canvas"></canvas>

    <div class="diagram-grid">

      <div id="node-iot">
        <div class="iot-badge">MÓDULO IOTI</div>
        <div class="hardware-stage">
            <img class="hardware-img" src={img_placa} alt="Placa IoT" />
            <div class="scan-laser"></div> </div>
        <div style="text-align:center; z-index:2;">
            <strong class="node-title">Dispositivo GPS</strong>
            <div class="node-subtitle" style="margin-top:6px; color: #1D4E89;">Envío de Telemetría</div>
        </div>
      </div>

      <div id="node-api" class="node animate-card" style="animation-delay: 0.4s;">
         <div class="icon-box"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"><path fill="#000000" d="M23.32 7.607a7.43 7.43 0 0 0-4.697-4.275a7.7 7.7 0 0 0-4.356-.05a6.36 6.36 0 0 0-3.334 2.583a4.4 4.4 0 0 0-.922-.881a4.9 4.9 0 0 0-3.104-.831a4 4 0 0 0-2.303 1.322a4.16 4.16 0 0 0-1.001 2.102a3.5 3.5 0 0 0-1.352.23A3.3 3.3 0 0 0 .749 8.929a3.66 3.66 0 0 0-.701 1.743a5 5 0 0 0 .811 3.494c.24.344.52.66.831.942c.204.19.438.345.691.46a.36.36 0 0 0 .5-.14a.34.34 0 0 0-.11-.38a2.4 2.4 0 0 1-.69-.591a4.5 4.5 0 0 1-.501-.741a4.3 4.3 0 0 1-.45-2.864c.076-.56.3-1.089.65-1.532c.232-.294.521-.536.851-.711a2.8 2.8 0 0 1 1.082-.32a5.6 5.6 0 0 1 1.222 0a.28.28 0 0 0 .33-.23a.27.27 0 0 0-.26-.301a8 8 0 0 0-.811-.16a3.7 3.7 0 0 1 1-1.513a3 3 0 0 1 1.813-.84c.503-.055 1.012 0 1.492.16c.505.146.98.38 1.402.69a2.26 2.26 0 0 1 1.002 1.683a.33.33 0 1 0 .65 0a2.6 2.6 0 0 0-.31-1.442a.22.22 0 0 0 .1-.09a5.62 5.62 0 0 1 3.145-2.193a6.64 6.64 0 0 1 3.815.27a6.54 6.54 0 0 1 4.005 3.695a8.1 8.1 0 0 1 .48 5.608a5.3 5.3 0 0 1-.48 1.141c-.197.332-.485.6-.83.771a.34.34 0 0 0-.151.44a.34.34 0 0 0 .44.151c.367-.171.692-.42.952-.73c.35-.455.618-.966.79-1.513a8.77 8.77 0 0 0-.19-6.279"/><path fill="#000000" d="M8.41 14.737a3 3 0 0 0-.231-.41a2.3 2.3 0 0 0-.3-.39l-.571-.492a1.31 1.31 0 0 0-1.522-.07c-.336.233-.6.556-.761.932a6.3 6.3 0 0 0-.451 1.431a11.8 11.8 0 0 0-.13 3.495c0 .511.14 1.002.24 1.522a.28.28 0 0 0 .32.25a.3.3 0 0 0 .251-.33q-.108-.736-.11-1.482c0-.36 0-.73.05-1.091q.402.075.811.1q.29.023.58 0q.291.015.582 0a11 11 0 0 0 1.111-.2q.132 1.081.15 2.173a.33.33 0 0 0 .651 0c.074-1.092.05-2.188-.07-3.275a8 8 0 0 0-.6-2.163M7.086 17.14h-.58a4 4 0 0 0-.571 0a4.4 4.4 0 0 0-.631.11c0-.2.06-.41.1-.61s.1-.46.16-.691c.116-.477.298-.936.541-1.362c.14-.23.33-.42.611-.24c.47.38.29.19.771.84c.306.58.525 1.2.65 1.843v.19zm6.931-3.985a5.7 5.7 0 0 0-1.853 0a3.4 3.4 0 0 0-1.171.22a1.25 1.25 0 0 0-.711.971a4.3 4.3 0 0 0 0 .802l.21 2.243l.29 3.074a.29.29 0 1 0 .581 0v-3.194a4.36 4.36 0 0 0 3.205-.691a1.76 1.76 0 0 0 .65-2.414a1.88 1.88 0 0 0-1.201-1.011m-.4 2.914a3.24 3.24 0 0 1-2.214.46h-.09v-1.902a.6.6 0 0 1 .06-.24c.05-.08.15-.09.24-.11q.314-.06.632-.06c.49-.08.99-.08 1.482 0a.84.84 0 0 1 .56.4c.36.59-.11 1.102-.7 1.452zm6.899-2.383a8.3 8.3 0 0 0-1.803-.21q-.504.002-1.001.09c-.51.08-1.001.22-1.512.28a.29.29 0 0 0-.29.28a.28.28 0 0 0 .27.3a9 9 0 0 0 1.782.191h.28c-.05.59-.13 1.182-.16 1.803v3.014a5 5 0 0 0-.65.09c-.471.11-.912.28-1.402.37a.29.29 0 0 0 0 .571a8 8 0 0 0 1.311.07h.791c.27 0 .731 0 1.102-.06a8 8 0 0 0 1.182-.13a.33.33 0 1 0 0-.651c-.521 0-1.002-.17-1.562-.23q.14-.821.17-1.653c0-.28.06-.56.08-.84c.02-.281 0-.561 0-.842a16 16 0 0 0-.24-1.592h.08q.745-.14 1.502-.19a.33.33 0 0 0 .35-.3a.32.32 0 0 0-.28-.361"/></svg></div>
         <strong class="node-title">Empresa</strong>
         <span class="node-subtitle">Sistema Créditos</span>
      </div>

      <div id="node-mqtt" class="node animate-card" style="animation-delay: 0.5s;">
         <div class="icon-box"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"><path fill="#000000" d="M6.526.003c-.188-.009-.372-.002-.494.06c-.176.09-.325.304-.463.444l-.928.943l-3.08 3.131l-.98.998c-.191.194-.412.367-.498.637c-.153.473-.047 1.112-.047 1.607v5.739c0 .376-.072.835.066 1.191c.097.25.296.424.479.61l.843.859l3.08 3.13l1.01 1.026c.147.149.315.384.518.455c.143.05.34.018.49.018h6.979c.272 0 .764.095 1.01-.03c.175-.09.324-.303.462-.443l.926-.941c1.022-1.04 2.057-2.064 3.08-3.104l.982-.998c.19-.192.41-.369.489-.639c.145-.494.029-1.096.029-1.607V9.708c0-.794-.01-1.589 0-2.383c.005-.38.094-.796-.049-1.164c-.092-.238-.295-.406-.469-.582l-.845-.86c-1.04-1.057-2.095-2.102-3.135-3.16c-.35-.355-.71-.699-1.063-1.052c-.139-.14-.302-.385-.49-.455c-.133-.05-.324-.016-.465-.016H7.04c-.137 0-.327-.025-.514-.033M11.72 1.46c.044 0 .04.003.047.01c.023.02.02.057-.004.078c-.009.008-.04.01-.32.023a8 8 0 0 0-.315.018c-.003.004-.212.909-.212.92c0 .003.01.012.021.02c.18.112.327.33.395.585c.032.121.042.213.042.354c0 .13-.013.237-.046.36l-.016.052l.021.025c.027.033.074.128.125.256c.02.05.037.09.038.09l.117.04c.158.052.358.111.75.224c.763.22 1.16.343 1.502.466c.824.298 1.326.598 1.545.922a.7.7 0 0 1 .117.272c.01.055.01.186-.002.24a1.4 1.4 0 0 1-.121.32q-.28.498-.953.637c-.319.066-.71.064-1.084-.006c-.339-.063-.646-.181-.772-.299a19 19 0 0 1-.527-.56a10 10 0 0 1-.6-.729c-.056-.077-.056-.076-.06-.062c-.008.025-.042.12-.045.125a2 2 0 0 1-.239.056c-.08.015-.197.032-.298.042a6 6 0 0 1-.551-.002c-.194-.019-.413-.053-.426-.069l-.037-.088l-.031-.08l-.03.041a9 9 0 0 1-.634.781c-.218.243-.495.534-.557.586a1 1 0 0 1-.252.143c-.22.092-.485.152-.808.186a7 7 0 0 1-.44.007l-.084-.007c-.345-.03-.655-.137-.877-.301a1.17 1.17 0 0 1-.408-.55a.7.7 0 0 1-.053-.269c0-.144.038-.258.13-.39c.185-.27.552-.517 1.142-.764c.426-.178.898-.332 1.898-.619c.419-.12.706-.208.87-.266c.053-.018.053-.02.06-.037c.065-.168.084-.216.107-.263a.4.4 0 0 1 .047-.077l.02-.021l-.014-.045a1.3 1.3 0 0 1-.05-.367a1.3 1.3 0 0 1 .136-.596a.9.9 0 0 1 .289-.336a.1.1 0 0 0 .033-.027c0-.004-.047-.213-.105-.465l-.106-.457l-.31-.014c-.26-.012-.314-.016-.325-.023a.05.05 0 0 1-.015-.067c.015-.027.004-.027.338-.011c.382.017.355.016.367.031c.005.007.09.22.19.473l.179.46l.027-.001a.6.6 0 0 1 .129 0l.028.002l.156-.399l.183-.469c.023-.058.028-.068.04-.074c.01-.006.075-.011.304-.021c.2-.01.29-.013.334-.014m-.345 4.756a4.5 4.5 0 0 1 .183.59c0 .003-.03.015-.076.029c-.18.054-.328.08-.555.098a5 5 0 0 1-.414.004a3.5 3.5 0 0 1-.576-.082a2 2 0 0 1-.271-.08c-.008-.01.148-.51.166-.532c.001-.002.018 0 .037.004c.117.024.3.048.45.059a3.3 3.3 0 0 0 1.025-.088q.026-.006.03-.002m-1.784.869s.023.005.047.014c.103.035.28.081.4.103c.544.1 1.096.077 1.544-.064l.058-.018a5 5 0 0 1 .074.602c0 .009-.008.012-.058.033a2.3 2.3 0 0 1-.701.156a3 3 0 0 1-.258.006c-.193-.001-.202-.001-.313-.012a3 3 0 0 1-.693-.142a2 2 0 0 1-.176-.073a4 4 0 0 1 .037-.369c.01-.064.037-.233.04-.236m-.08 1.014l.055.02c.648.24 1.514.256 2.113.038l.047-.017v.023a3 3 0 0 1-.078.58l-.014.057l-.05.02a2.2 2.2 0 0 1-.59.124a5 5 0 0 1-.4.01a3 3 0 0 1-.934-.18c-.074-.028-.065-.013-.09-.138a3 3 0 0 1-.055-.473zm.207 1.095a.3.3 0 0 1 .057.014a3.3 3.3 0 0 0 1.213.113a3 3 0 0 0 .463-.08c.001.002-.056.11-.078.147a2 2 0 0 1-.28.355a2 2 0 0 1-.236.201a.5.5 0 0 1-.162.07a.6.6 0 0 1-.213-.003a.5.5 0 0 1-.133-.055a1.9 1.9 0 0 1-.61-.71a.3.3 0 0 1-.02-.052m-.744 1.373h.846v3.438h-.71l-.027-.777l-.078-1.885zm2.291 0h.71l.08 2.522l.027.639l-.028.228l-.244.049l-.545.027zM9.65 15.745c.176.002.348.024.498.055c.169.035.361.093.477.232c.125.152.125.362.125.55c0 .367.014.74-.002 1.108c-.024.535-.638.522-.762.971c-.153 0-.378.042-.518-.03c-.148-.074-.248-.239-.383-.337c-.171-.125-.354-.213-.418-.438c-.079-.278-.017-.652-.017-.94c0-.313-.08-.727.193-.946c.213-.171.513-.227.807-.225m-1.78.018c.119 0 .218.042.253.16c.062.214.01.52.01.742v1.607h-.737v-1.109c-.388.275-.535.337-.9-.027V18.3h-.737v-2.44c.164-.044.32-.103.493-.072c.33.06.551.483.681.766c.153-.183.248-.408.41-.582c.083-.089.331-.208.528-.21m5.223.07c0 .13.092.492-.017.582c-.138.113-.485-.019-.567.172c-.06.139-.015.372-.015.521v1.164h-.791V16.5l-.627-.057l-.055-.582zm.217 0h2.045v.61l-.6.056v1.8h-.763v-1.773l-.655-.084zm-3.924.639v1.273l.6-.027v-1.246z" class="cls-1"/></svg></div>
         <strong class="node-title">Broker MQTT</strong>
      </div>

      <div id="node-core" class="node animate-card" style="animation-delay: 0.7s;">
         <div class="icon-box" style="width:50px; height:50px;"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 128 128"><path fill="#77bc1f" d="M116.452 6.643a59 59 0 0 1-6.837 12.136A64.25 64.25 0 0 0 64.205-.026C28.984-.026 0 28.982 0 64.242a64.32 64.32 0 0 0 19.945 46.562l2.368 2.1a64.22 64.22 0 0 0 41.358 15.122c33.487 0 61.637-26.24 64.021-59.683c1.751-16.371-3.051-37.077-11.24-61.7M29.067 111.17a5.5 5.5 0 0 1-4.269 2.034c-3.018 0-5.487-2.484-5.487-5.502s2.485-5.501 5.487-5.501c1.25 0 2.485.433 3.452 1.234c2.351 1.9 2.718 5.384.817 7.735m87.119-19.238c-15.843 21.122-49.68 14.003-71.376 15.02c0 0-3.852.234-7.721.867c0 0 1.45-.617 3.335-1.334c15.226-5.301 22.43-6.335 31.685-11.086c17.427-8.869 34.654-28.274 38.24-48.463c-6.637 19.422-26.75 36.11-45.077 42.895c-12.557 4.635-35.238 9.136-35.238 9.136l-.917-.484c-15.442-7.518-15.91-40.977 12.157-51.78c12.291-4.735 24.048-2.134 37.323-5.302c14.175-3.367 30.568-14.004 37.238-27.874c7.471 22.19 16.46 56.932.35 78.405z"/></svg></div>
         <strong class="node-title" style="font-size:1.4rem;">Spring Boot</strong>
         <span class="node-subtitle">Gestión Centralizada</span>
      </div>

      <div id="node-n8n" class="node animate-card" style="animation-delay: 0.9s;">
         <div style="display:flex; justify-content:space-between; align-items:center;">
            <div>
                <strong class="node-title">Orquestador n8n</strong>
                <span class="node-subtitle" style="display:block;">Motor de Flujo</span>
            </div>
            <div class="icon-box" style="margin:0;"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"><path fill="#db2777" d="M21.474 5.684a2.53 2.53 0 0 0-2.447 1.895H16.13a2.526 2.526 0 0 0-2.492 2.11l-.103.624a1.26 1.26 0 0 1-1.246 1.055h-1.001a2.527 2.527 0 0 0-4.893 0H4.973a2.527 2.527 0 1 0 0 1.264h1.422a2.527 2.527 0 0 0 4.894 0h1a1.26 1.26 0 0 1 1.247 1.055l.103.623a2.526 2.526 0 0 0 2.492 2.111h.37a2.527 2.527 0 1 0 0-1.263h-.37a1.26 1.26 0 0 1-1.246-1.056l-.103-.623A2.52 2.52 0 0 0 13.96 12a2.52 2.52 0 0 0 .82-1.48l.104-.622a1.26 1.26 0 0 1 1.246-1.056h2.896a2.527 2.527 0 1 0 2.447-3.158m0 1.263a1.263 1.263 0 0 1 1.263 1.263a1.263 1.263 0 0 1-1.263 1.264A1.263 1.263 0 0 1 20.21 8.21a1.263 1.263 0 0 1 1.264-1.263m-18.948 3.79A1.263 1.263 0 0 1 3.79 12a1.263 1.263 0 0 1-1.264 1.263A1.263 1.263 0 0 1 1.263 12a1.263 1.263 0 0 1 1.263-1.263m6.316 0A1.263 1.263 0 0 1 10.105 12a1.263 1.263 0 0 1-1.263 1.263A1.263 1.263 0 0 1 7.58 12a1.263 1.263 0 0 1 1.263-1.263m10.106 3.79a1.263 1.263 0 0 1 1.263 1.263a1.263 1.263 0 0 1-1.263 1.263a1.263 1.263 0 0 1-1.264-1.263a1.263 1.263 0 0 1 1.263-1.264"/></svg></div>
         </div>
      </div>

      <div id="node-ai" class="node animate-card" style="animation-delay: 1.1s;">
         <div class="icon-box"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="99.609375" viewBox="0 0 256 255"><defs><linearGradient id="IconifyId19abe7d2022ee32662" x1="12.959%" x2="79.639%" y1="12.039%" y2="78.201%"><stop offset="0%" stop-color="#387EB8"/><stop offset="100%" stop-color="#366994"/></linearGradient><linearGradient id="IconifyId19abe7d2022ee32663" x1="19.128%" x2="90.742%" y1="20.579%" y2="88.429%"><stop offset="0%" stop-color="#FFE052"/><stop offset="100%" stop-color="#FFC331"/></linearGradient></defs><path fill="url(#IconifyId19abe7d2022ee32662)" d="M126.916.072c-64.832 0-60.784 28.115-60.784 28.115l.072 29.128h61.868v8.745H41.631S.145 61.355.145 126.77c0 65.417 36.21 63.097 36.21 63.097h21.61v-30.356s-1.165-36.21 35.632-36.21h61.362s34.475.557 34.475-33.319V33.97S194.67.072 126.916.072M92.802 19.66a11.12 11.12 0 0 1 11.13 11.13a11.12 11.12 0 0 1-11.13 11.13a11.12 11.12 0 0 1-11.13-11.13a11.12 11.12 0 0 1 11.13-11.13"/><path fill="url(#IconifyId19abe7d2022ee32663)" d="M128.757 254.126c64.832 0 60.784-28.115 60.784-28.115l-.072-29.127H127.6v-8.745h86.441s41.486 4.705 41.486-60.712c0-65.416-36.21-63.096-36.21-63.096h-21.61v30.355s1.165 36.21-35.632 36.21h-61.362s-34.475-.557-34.475 33.32v56.013s-5.235 33.897 62.518 33.897m34.114-19.586a11.12 11.12 0 0 1-11.13-11.13a11.12 11.12 0 0 1 11.13-11.131a11.12 11.12 0 0 1 11.13 11.13a11.12 11.12 0 0 1-11.13 11.13"/></svg></div>
         <strong class="node-title">Motor IA</strong>
         <span class="node-subtitle">ML Scoring</span>
      </div>
      
  <div id="node-movil" class="node animate-card" style="animation-delay: 1.3s;">
         <div class="icon-box"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="123.828125" viewBox="0 0 256 317"><defs><linearGradient id="IconifyId19abe7d2022ee32669" x1="3.952%" x2="75.897%" y1="26.993%" y2="52.919%"><stop offset="0%"/><stop offset="100%" stop-opacity="0"/></linearGradient></defs><path fill="#47C5FB" d="M157.666.001L.001 157.666l48.8 48.8L255.268.001zm-1.099 145.396l-84.418 84.418l48.984 49.716l48.71-48.71l85.425-85.424z"/><path fill="#00569E" d="m121.133 279.531l37.082 37.082h97.052l-85.425-85.792z"/><path fill="#00B5F8" d="m71.6 230.364l48.801-48.801l49.441 49.258l-48.709 48.71z"/><path fill="url(#IconifyId19abe7d2022ee32669)" fill-opacity=".8" d="m121.133 279.531l40.56-13.459l4.029-31.131z"/></svg></div>
         <strong class="node-title">Aplicativo Móvil</strong>
         <span class="node-subtitle">Cotizaciones credticias</span>
      </div>
      

      <div id="node-front" class="node animate-card" style="animation-delay: 1.3s;">
         <div class="icon-box"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 128 128"><circle cx="64" cy="64" r="64"/><path fill="url(#IconifyId19abe7d2022ee32666)" d="M106.317 112.014L49.167 38.4H38.4v51.179h8.614v-40.24l52.54 67.884a64 64 0 0 0 6.763-5.209"/><path fill="url(#IconifyId19abe7d2022ee32667)" d="M81.778 38.4h8.533v51.2h-8.533z"/><defs><linearGradient id="IconifyId19abe7d2022ee32666" x1="109" x2="144.5" y1="116.5" y2="160.5" gradientTransform="scale(.71111)" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient id="IconifyId19abe7d2022ee32667" x1="121" x2="120.799" y1="54" y2="106.875" gradientTransform="scale(.71111)" gradientUnits="userSpaceOnUse"><stop stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient></defs></svg></div>
         <strong class="node-title">Admin Dashboard</strong>
         <span class="node-subtitle">Monitoreo Real-Time</span>
      </div>

      <div id="node-db" class="node animate-card" style="animation-delay: 1.1s;">
         <div class="icon-box"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="103.125" viewBox="0 0 256 264"><path d="M255.008 158.086c-1.535-4.649-5.556-7.887-10.756-8.664c-2.452-.366-5.26-.21-8.583.475c-5.792 1.195-10.089 1.65-13.225 1.738c11.837-19.985 21.462-42.775 27.003-64.228c8.96-34.689 4.172-50.492-1.423-57.64C233.217 10.847 211.614.683 185.552.372c-13.903-.17-26.108 2.575-32.475 4.549c-5.928-1.046-12.302-1.63-18.99-1.738c-12.537-.2-23.614 2.533-33.079 8.15c-5.24-1.772-13.65-4.27-23.362-5.864c-22.842-3.75-41.252-.828-54.718 8.685C6.622 25.672-.937 45.684.461 73.634c.444 8.874 5.408 35.874 13.224 61.48c4.492 14.718 9.282 26.94 14.237 36.33c7.027 13.315 14.546 21.156 22.987 23.972c4.731 1.576 13.327 2.68 22.368-4.85c1.146 1.388 2.675 2.767 4.704 4.048c2.577 1.625 5.728 2.953 8.875 3.74c11.341 2.835 21.964 2.126 31.027-1.848c.056 1.612.099 3.152.135 4.482c.06 2.157.12 4.272.199 6.25c.537 13.374 1.447 23.773 4.143 31.049c.148.4.347 1.01.557 1.657c1.345 4.118 3.594 11.012 9.316 16.411c5.925 5.593 13.092 7.308 19.656 7.308c3.292 0 6.433-.432 9.188-1.022c9.82-2.105 20.973-5.311 29.041-16.799c7.628-10.86 11.336-27.217 12.007-52.99q.13-1.094.244-2.088l.16-1.362l1.797.158l.463.031c10.002.456 22.232-1.665 29.743-5.154c5.935-2.754 24.954-12.795 20.476-26.351"/><path fill="#336791" d="M237.906 160.722c-29.74 6.135-31.785-3.934-31.785-3.934c31.4-46.593 44.527-105.736 33.2-120.211c-30.904-39.485-84.399-20.811-85.292-20.327l-.287.052c-5.876-1.22-12.451-1.946-19.842-2.067c-13.456-.22-23.664 3.528-31.41 9.402c0 0-95.43-39.314-90.991 49.444c.944 18.882 27.064 142.873 58.218 105.422c11.387-13.695 22.39-25.274 22.39-25.274c5.464 3.63 12.006 5.482 18.864 4.817l.533-.452c-.166 1.7-.09 3.363.213 5.332c-8.026 8.967-5.667 10.541-21.711 13.844c-16.235 3.346-6.698 9.302-.471 10.86c7.549 1.887 25.013 4.561 36.813-11.958l-.47 1.885c3.144 2.519 5.352 16.383 4.982 28.952c-.37 12.568-.617 21.197 1.86 27.937c2.479 6.74 4.948 21.905 26.04 17.386c17.623-3.777 26.756-13.564 28.027-29.89c.901-11.606 2.942-9.89 3.07-20.267l1.637-4.912c1.887-15.733.3-20.809 11.157-18.448l2.64.232c7.99.363 18.45-1.286 24.589-4.139c13.218-6.134 21.058-16.377 8.024-13.686z"/><path fill="#FFF" d="M108.076 81.525c-2.68-.373-5.107-.028-6.335.902c-.69.523-.904 1.129-.962 1.546c-.154 1.105.62 2.327 1.096 2.957c1.346 1.784 3.312 3.01 5.258 3.28q.423.059.842.058c3.245 0 6.196-2.527 6.456-4.392c.325-2.336-3.066-3.893-6.355-4.35m88.784.073c-.256-1.831-3.514-2.353-6.606-1.923c-3.088.43-6.082 1.824-5.832 3.659c.2 1.427 2.777 3.863 5.827 3.863q.387 0 .78-.054c2.036-.282 3.53-1.575 4.24-2.32c1.08-1.136 1.706-2.402 1.591-3.225"/><path fill="#FFF" d="M247.802 160.025c-1.134-3.429-4.784-4.532-10.848-3.28c-18.005 3.716-24.453 1.142-26.57-.417c13.995-21.32 25.508-47.092 31.719-71.137c2.942-11.39 4.567-21.968 4.7-30.59c.147-9.463-1.465-16.417-4.789-20.665c-13.402-17.125-33.072-26.311-56.882-26.563c-16.369-.184-30.199 4.005-32.88 5.183c-5.646-1.404-11.801-2.266-18.502-2.376c-12.288-.199-22.91 2.743-31.704 8.74c-3.82-1.422-13.692-4.811-25.765-6.756c-20.872-3.36-37.458-.814-49.294 7.571c-14.123 10.006-20.643 27.892-19.38 53.16c.425 8.501 5.269 34.653 12.913 59.698c10.062 32.964 21 51.625 32.508 55.464c1.347.449 2.9.763 4.613.763c4.198 0 9.345-1.892 14.7-8.33a530 530 0 0 1 20.261-22.926c4.524 2.428 9.494 3.784 14.577 3.92q.016.2.035.398a118 118 0 0 0-2.57 3.175c-3.522 4.471-4.255 5.402-15.592 7.736c-3.225.666-11.79 2.431-11.916 8.435c-.136 6.56 10.125 9.315 11.294 9.607c4.074 1.02 7.999 1.523 11.742 1.523c9.103 0 17.114-2.992 23.516-8.781c-.197 23.386.778 46.43 3.586 53.451c2.3 5.748 7.918 19.795 25.664 19.794c2.604 0 5.47-.303 8.623-.979c18.521-3.97 26.564-12.156 29.675-30.203c1.665-9.645 4.522-32.676 5.866-45.03c2.836.885 6.487 1.29 10.434 1.289c8.232 0 17.731-1.749 23.688-4.514c6.692-3.108 18.768-10.734 16.578-17.36m-44.106-83.48c-.061 3.647-.563 6.958-1.095 10.414c-.573 3.717-1.165 7.56-1.314 12.225c-.147 4.54.42 9.26.968 13.825c1.108 9.22 2.245 18.712-2.156 28.078a37 37 0 0 1-1.95-4.009c-.547-1.326-1.735-3.456-3.38-6.404c-6.399-11.476-21.384-38.35-13.713-49.316c2.285-3.264 8.084-6.62 22.64-4.813m-17.644-61.787c21.334.471 38.21 8.452 50.158 23.72c9.164 11.711-.927 64.998-30.14 110.969a171 171 0 0 0-.886-1.117l-.37-.462c7.549-12.467 6.073-24.802 4.759-35.738c-.54-4.488-1.05-8.727-.92-12.709c.134-4.22.692-7.84 1.232-11.34c.663-4.313 1.338-8.776 1.152-14.037c.139-.552.195-1.204.122-1.978c-.475-5.045-6.235-20.144-17.975-33.81c-6.422-7.475-15.787-15.84-28.574-21.482c5.5-1.14 13.021-2.203 21.442-2.016M66.674 175.778c-5.9 7.094-9.974 5.734-11.314 5.288c-8.73-2.912-18.86-21.364-27.791-50.624c-7.728-25.318-12.244-50.777-12.602-57.916c-1.128-22.578 4.345-38.313 16.268-46.769c19.404-13.76 51.306-5.524 64.125-1.347c-.184.182-.376.352-.558.537c-21.036 21.244-20.537 57.54-20.485 59.759c-.002.856.07 2.068.168 3.735c.362 6.105 1.036 17.467-.764 30.334c-1.672 11.957 2.014 23.66 10.111 32.109a36 36 0 0 0 2.617 2.468c-3.604 3.86-11.437 12.396-19.775 22.426m22.479-29.993c-6.526-6.81-9.49-16.282-8.133-25.99c1.9-13.592 1.199-25.43.822-31.79c-.053-.89-.1-1.67-.127-2.285c3.073-2.725 17.314-10.355 27.47-8.028c4.634 1.061 7.458 4.217 8.632 9.645c6.076 28.103.804 39.816-3.432 49.229c-.873 1.939-1.698 3.772-2.402 5.668l-.546 1.466c-1.382 3.706-2.668 7.152-3.465 10.424c-6.938-.02-13.687-2.984-18.819-8.34m1.065 37.9c-2.026-.506-3.848-1.385-4.917-2.114c.893-.42 2.482-.992 5.238-1.56c13.337-2.745 15.397-4.683 19.895-10.394c1.031-1.31 2.2-2.794 3.819-4.602l.002-.002c2.411-2.7 3.514-2.242 5.514-1.412c1.621.67 3.2 2.702 3.84 4.938c.303 1.056.643 3.06-.47 4.62c-9.396 13.156-23.088 12.987-32.921 10.526m69.799 64.952c-16.316 3.496-22.093-4.829-25.9-14.346c-2.457-6.144-3.665-33.85-2.808-64.447c.011-.407-.047-.8-.159-1.17a15.4 15.4 0 0 0-.456-2.162c-1.274-4.452-4.379-8.176-8.104-9.72c-1.48-.613-4.196-1.738-7.46-.903c.696-2.868 1.903-6.107 3.212-9.614l.549-1.475c.618-1.663 1.394-3.386 2.214-5.21c4.433-9.848 10.504-23.337 3.915-53.81c-2.468-11.414-10.71-16.988-23.204-15.693c-7.49.775-14.343 3.797-17.761 5.53c-.735.372-1.407.732-2.035 1.082c.954-11.5 4.558-32.992 18.04-46.59c8.489-8.56 19.794-12.788 33.568-12.56c27.14.444 44.544 14.372 54.366 25.979c8.464 10.001 13.047 20.076 14.876 25.51c-13.755-1.399-23.11 1.316-27.852 8.096c-10.317 14.748 5.644 43.372 13.315 57.129c1.407 2.521 2.621 4.7 3.003 5.626c2.498 6.054 5.732 10.096 8.093 13.046c.724.904 1.426 1.781 1.96 2.547c-4.166 1.201-11.649 3.976-10.967 17.847c-.55 6.96-4.461 39.546-6.448 51.059c-2.623 15.21-8.22 20.875-23.957 24.25m68.104-77.936c-4.26 1.977-11.389 3.46-18.161 3.779c-7.48.35-11.288-.838-12.184-1.569c-.42-8.644 2.797-9.547 6.202-10.503c.535-.15 1.057-.297 1.561-.473q.469.383 1.032.756c6.012 3.968 16.735 4.396 31.874 1.271l.166-.033c-2.042 1.909-5.536 4.471-10.49 6.772"/></svg></div>
         <strong class="node-title">PostgreSQL</strong>
      </div>

    

    </div>
  </div>

  <script>
    function drawSystem() {
      const container = document.getElementById('slide-container');
      const canvas = document.getElementById('connections-canvas');
      
      if (!container || !canvas || !(canvas instanceof HTMLCanvasElement)) return;

      canvas.width = container.offsetWidth;
      canvas.height = container.offsetHeight;
      const ctx = canvas.getContext('2d');
      if (!ctx) return;
      
      // Animación de flujo constante (Hormigas marchando)
      const time = Date.now() * 0.001; 
      const speed = 30; // Pixeles por segundo
      const dashOffset = -(time * speed); // Movimiento continuo

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Estilo de línea "Activa"
      ctx.lineWidth = 2;
      ctx.strokeStyle = '#cbd5e1'; 
      // Patrón de línea: 10px linea, 10px espacio
      ctx.setLineDash([10, 10]); 
      ctx.lineDashOffset = dashOffset; // APLICAMOS LA ANIMACIÓN AQUÍ

      function connect(id1, id2, { type = 'curved', bidirectional = false } = {}) {
        const el1 = document.getElementById(id1);
        const el2 = document.getElementById(id2);
        if(!el1 || !el2) return;

        const r1 = el1.getBoundingClientRect();
        const r2 = el2.getBoundingClientRect();
        const c = container.getBoundingClientRect();

        // Detectar si el elemento ya es visible (opacity > 0) para dibujar la línea
        // Esto hace que las líneas aparezcan junto con las cajas
        const style1 = window.getComputedStyle(el1);
        if (style1.opacity === '0') return; // No dibujar si la caja aun no aparece

        const x1 = r1.left + r1.width / 2 - c.left;
        const y1 = r1.top + r1.height / 2 - c.top;
        const x2 = r2.left + r2.width / 2 - c.left;
        const y2 = r2.top + r2.height / 2 - c.top;

        ctx.beginPath();
        ctx.moveTo(x1, y1);

        if (type === 'straight') {
            ctx.lineTo(x2, y2);
        } else {
            const isHorizontal = Math.abs(x2 - x1) > Math.abs(y2 - y1);
            if (isHorizontal) {
                const midX = (x1 + x2) / 2;
                ctx.bezierCurveTo(midX, y1, midX, y2, x2, y2);
            } else {
                const midY = (y1 + y2) / 2;
                ctx.bezierCurveTo(x1, midY, x2, midY, x2, y2);
            }
        }
        ctx.stroke();

        // Dibujar puntos en los extremos (sin dash, sólidos)
        ctx.save();
        ctx.setLineDash([]);
        ctx.fillStyle = '#1D4E89';
        ctx.beginPath();
        ctx.arc(x2, y2, 4, 0, Math.PI * 2);
        ctx.fill();
        if (bidirectional) {
            ctx.beginPath();
            ctx.arc(x1, y1, 4, 0, Math.PI * 2);
            ctx.fill();
        }
        ctx.restore();
      }

      // CONEXIONES
      connect('node-iot', 'node-mqtt');
      connect('node-mqtt', 'node-core');
      connect('node-api', 'node-n8n', { bidirectional: true });
      connect('node-n8n', 'node-core', { type: 'straight', bidirectional: true });
      connect('node-n8n', 'node-ai');
      connect('node-core', 'node-db', { type: 'straight', bidirectional: true });
      connect('node-core', 'node-front', { bidirectional: true });
      connect('node-core', 'node-movil', { bidirectional: true });


      requestAnimationFrame(drawSystem);
    }

    window.addEventListener('load', drawSystem);
    window.addEventListener('resize', drawSystem);
    setTimeout(drawSystem, 100);
  </script>
</Layout>